# Auth Monitor - Blocked IPs Configuration
# Generated: 2026-01-25 20:15:39
# Total IPs: 3

# Adicione estas linhas no bloco http {} do nginx.conf
# ou em /etc/nginx/conf.d/blocked-ips.conf

geo $blocked_ip {
    default 0;

    201.47.36.86 1; # TEMP until 2026-01-25 20:59:29 - Exceeded threshold of 10 failed authentication attempts
    177.112.59.162 1; # TEMP until 2026-01-25 20:59:29 - Exceeded threshold of 10 failed authentication attempts
    15:38:42 1; # TEMP until 2026-01-25 20:59:29 - Exceeded threshold of 10 failed authentication attempts
}

# No bloco server {}, adicione:
# if ($blocked_ip) {
#     return 403 "Access Denied - IP Blocked";
# }

# Ou use limit_req_zone para rate limiting:
limit_req_zone $binary_remote_addr zone=auth_limit:10m rate=5r/m;

# No location /login ou /auth:
# limit_req zone=auth_limit burst=3 nodelay;
